# secure-api-lab
## –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ3: –†–æ–∑—Ä–æ–±–∫–∞ —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑–∞—Ö–∏—â–µ–Ω–æ–≥–æ REST API –Ω–∞ Node.js —Ç–∞ Express

### –î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞: –ö–æ–Ω—Å—Ç—Ä—É—é–≤–∞–Ω–Ω—è –ü–ó
### –í–∏–∫–æ–Ω–∞–≤: *–ë–∏–∫–æ–≤ –í—ñ–∫—Ç–æ—Ä –∑ –≥—Ä—É–ø–∏ –Ü–ü–ó 3.03*
---
## –û–ø–∏—Å –ø—Ä–æ–µ–∫—Ç—É
–¶–µ–π –ø—Ä–æ–µ–∫—Ç —î –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—é —Ä–æ–±–æ—Ç–æ—é, —Å–ø—Ä—è–º–æ–≤–∞–Ω–æ—é –Ω–∞ —Ä–æ–∑—Ä–æ–±–∫—É —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑–∞—Ö–∏—â–µ–Ω–æ–≥–æ REST API –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Node.js —Ç–∞ Express. –ú–µ—Ç–æ—é —î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ API, —è–∫–∏–π –∑–∞–±–µ–∑–ø–µ—á—É—î –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é —Ç–∞ –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ—à–∏—Ä–µ–Ω–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π.

## –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫—É

–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
```bash
npm install
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
npm start
```
–ü—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é:  
üëâ http://localhost:2000

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞
(–°–µ—Ä–≤–µ—Ä –º–∞—î –±—É—Ç–∏ –∑–∞–ø—É—â–µ–Ω–∏–π!)
```bash
npm test
```

---
## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É
```
WORKSHOP_3_SECURE-API-LAB/
‚îú‚îÄ scrins/...
‚îú‚îÄ data.js
‚îú‚îÄ server.js
‚îú‚îÄ test-client.js
‚îú‚îÄ package.json
‚îî‚îÄ README.md
```

## –°–∫—Ä—ñ–Ω—à–æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏

![–°–∫—Ä—ñ–Ω—à–æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ–µ–∫—Ç—É](scrins/structur.jpg)

---
## –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏

| HTTP –ú–µ—Ç–æ–¥ | URL | –û–ø–∏—Å | –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ | –¢—ñ–ª–æ –∑–∞–ø–∏—Ç—É (JSON) | –ú–æ–∂–ª–∏–≤—ñ –∫–æ–¥–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ |
|-------------|-----|------|----------------------|----------------------|---------------------------|
| **GET** | `/documents` | –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ | `X-Login`, `X-Password` | ‚Äî | 200 OK, 401 Unauthorized |
| **POST** | `/documents` | –î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π –¥–æ–∫—É–º–µ–Ω—Ç | `X-Login`, `X-Password` | `{ "title": "Text", "content": "Text" }` | 201 Created, 400 Bad Request, 401 Unauthorized |
| **DELETE** | `/documents/:id` | –í–∏–¥–∞–ª–∏—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç –∑–∞ ID | `X-Login`, `X-Password` | ‚Äî | 204 No Content, 401 Unauthorized, 404 Not Found |
| **GET** | `/employees` | –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ | `X-Login`, `X-Password` (—Ä–æ–ª—å `admin`) | ‚Äî | 200 OK, 401 Unauthorized, 403 Forbidden |

---

## HTTP-–∫–æ–¥–∏, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º

| –ö–æ–¥ | –ó–Ω–∞—á–µ–Ω–Ω—è | –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è |
|------|-----------|-----------------------|
| **200 OK** | –ó–∞–ø–∏—Ç –≤–∏–∫–æ–Ω–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ | GET /documents, GET /employees |
| **201 Created** | –°—Ç–≤–æ—Ä–µ–Ω–æ –Ω–æ–≤–∏–π —Ä–µ—Å—É—Ä—Å | POST /documents |
| **204 No Content** | –í–∏–¥–∞–ª–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–æ | DELETE /documents/:id |
| **400 Bad Request** | –ù–µ–≤—ñ—Ä–Ω—ñ –¥–∞–Ω—ñ —É –∑–∞–ø–∏—Ç—ñ | –í—ñ–¥—Å—É—Ç–Ω—ñ–π title –∞–±–æ content |
| **401 Unauthorized** | –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á | –ù–µ–º–∞—î –∞–±–æ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ X-Login / X-Password |
| **403 Forbidden** | –ù–µ–º–∞—î –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–µ–∑ —Ä–æ–ª—ñ admin –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ /employees |
| **404 Not Found** | –†–µ—Å—É—Ä—Å –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ | –í–∏–¥–∞–ª–µ–Ω–Ω—è –Ω–µ—ñ—Å–Ω—É—é—á–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ |

---

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ä–æ–±–æ—Ç–∏ —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

**–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ —Ä—è–¥–∫–∞ –±—Ä–∞—É–∑–µ—Ä—É :**

![alt](scrins/1.1.jpg)

**–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ Postman :**

*GET /documents*

![alt](scrins/1.2.jpg)

*GET /employees (`X-Login: user1` ,`X-Password: password123`)*

![alt](scrins/1.3.jpg)

*GET /documents (`X-Login: user1` ,`X-Password: password123`)*

![alt](scrins/1.4.jpg)

*GET /employees (`X-Login: admin1` ,`X-Password: password123`)*

![alt](scrins/1.5.jpg)

*POST /documents (`X-Login: user1` ,`X-Password: password123`) (`{ "title": "Test Doc", "content": "..." }`)*

![alt](scrins/1.6.jpg)


*POST /documents (`X-Login: user1` ,`X-Password: password123`) (`{ "content": "..." }`)*

![alt](scrins/1.7.jpg)

*DELETE /documents/1 (`X-Login: admin1` ,`X-Password: password123`)*

![alt](scrins/1.8.jpg)

*GET /non-existend (`X-Login: admin1` ,`X-Password: password123`)*

![alt](scrins/1.9.jpg)

**–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ NODE-—Å–∫—Ä–∏–ø—Ç :**

*–°–∫—Ä–∏–ø—Ç:*
```javascript
// –ê–¥—Ä–µ—Å–∞ –≤–∞—à–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

const BASE_URL = 'http://localhost:2000';

// –î–∞–Ω—ñ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
const userCredentials = {
  'X-Login': 'user1',
  'X-Password': 'password123',
};

const adminCredentials = {
  'X-Login': 'admin1',
  'X-Password': 'password123',
};

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
const runTests = async () => {
  console.log('--- Running API Tests ---');
  // –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –£—Å–ø—ñ—à–Ω–∏–π –∑–∞–ø–∏—Ç –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  console.log('\n[TEST 1] Getting documents as a user...');

  try {
    const response = await fetch(`${BASE_URL}/documents`, {
      method: 'GET',
      headers: userCredentials,
    });

    const data = await response.json();

    console.log('Status:', response.status);
    console.log('Data:', data);
  } catch (error) {
    console.error('Error:', error.message);
  }

  // –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –°–ø—Ä–æ–±–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ –∞–¥–º—ñ–Ω-—Ä–µ—Å—É—Ä—Å—É –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  console.log('\n[TEST 2] Trying to get employees as a user...');

  try {
    const response = await fetch(`${BASE_URL}/employees`, {
      method: 'GET',
      headers: userCredentials,
    });

    const data = await response.json();
    console.log('Status:', response.status); // –û—á—ñ–∫—É—î–º–æ 403
    console.log('Data:', data);
  } catch (error) {
    console.error('Error:', error.message);
  }

  // –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –£—Å–ø—ñ—à–Ω–∏–π –∑–∞–ø–∏—Ç –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

  console.log('\n[TEST 3] Getting employees as an admin...');

  try {
    const response = await fetch(`${BASE_URL}/employees`, {
      method: 'GET',
      headers: adminCredentials,
    });

    const data = await response.json();
    console.log('Status:', response.status);

    console.log('Data:', data);
  } catch (error) {
    console.error('Error:', error.message);
  }

  console.log('\n--- Tests finished ---');
};

runTests();
```

*–†–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç—É :*

![alt](scrins/1.10.jpg)

---